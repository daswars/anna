{{/*
  Thumbnail Partial - optimized for gallery grids

  Usage:
    {{ partial "thumbnail.html" (dict
      "src" "/images/paintings/2022/painting.jpg"
      "alt" "Artwork title"
      "class" "optional-css-classes"
    ) }}

  Generates responsive WebP thumbnails with srcset
*/}}

{{- $src := .src -}}
{{- $alt := .alt | default "" -}}
{{- $class := .class | default "" -}}

{{/* Convert /images/ path to assets path */}}
{{- $assetPath := replace $src "/images/" "images/" -}}

{{/* Get the image resource */}}
{{- $image := resources.Get $assetPath -}}

{{- if $image -}}
  {{/* Generate responsive thumbnails */}}
  {{- $thumb300 := $image.Resize "300x webp q55" -}}
  {{- $thumb400 := $image.Resize "400x webp q55" -}}
  {{- $thumb600 := $image.Resize "600x webp q55" -}}

  <img
    src="{{ $thumb400.RelPermalink }}"
    srcset="{{ $thumb300.RelPermalink }} 300w, {{ $thumb400.RelPermalink }} 400w, {{ $thumb600.RelPermalink }} 600w"
    sizes="(max-width: 640px) 300px, (max-width: 1024px) 400px, 400px"
    alt="{{ $alt }}"
    width="{{ $thumb400.Width }}"
    height="{{ $thumb400.Height }}"
    loading="lazy"
    decoding="async"
    {{ with $class }}class="{{ . }}"{{ end }}
  >
{{- else -}}
  {{/* Fallback if image not found */}}
  <img src="{{ $src }}" alt="{{ $alt }}" {{ with $class }}class="{{ . }}"{{ end }} loading="lazy">
{{- end -}}
