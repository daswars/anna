{{/*
  Artwork Card Partial

  Usage:
    {{ partial "_artwork-card.html" (dict
      "artwork" $painting
      "index" $idx
      "lang" $.Site.Language.Lang
      "context" $
      "type" "button"       // "button" (for lightbox) or "link" (for navigation)
      "linkUrl" "/paintings" // required if type is "link"
      "showDimensions" true  // optional, default true
      "priority" false       // optional, use thumbnail-priority for LCP
    ) }}
*/}}

{{ $artwork := .artwork }}
{{ $index := .index | default 0 }}
{{ $lang := .lang }}
{{ $context := .context }}
{{ $type := .type | default "button" }}
{{ $linkUrl := .linkUrl | default "" }}
{{ $showDimensions := .showDimensions | default true }}
{{ $priority := .priority | default false }}

{{ $title := cond (eq $lang "de") $artwork.title_de $artwork.title_en }}
{{ $medium := cond (eq $lang "de") $artwork.medium_de $artwork.medium_en }}
{{ $viewText := i18n "view_artwork" $context }}
{{ $artworkByArtist := i18n "artwork_by_artist" $context }}

{{/* Wrapper element - button or link */}}
{{ if eq $type "button" }}
<button
  type="button"
  onclick="openLightbox({{ $index }})"
  class="group cursor-pointer flex flex-col gap-5 text-left w-full focus:outline-none focus-visible:ring-2 focus-visible:ring-stone-400 dark:focus-visible:ring-stone-600 focus-visible:ring-offset-4 focus-visible:ring-offset-white dark:focus-visible:ring-offset-stone-950 rounded"
>
{{ else }}
<a
  href="{{ $linkUrl | relLangURL }}"
  title="{{ $title }} â€“ {{ $artworkByArtist }}"
  class="group flex flex-col gap-5 text-left w-full focus:outline-none focus-visible:ring-2 focus-visible:ring-stone-400 dark:focus-visible:ring-stone-600 focus-visible:ring-offset-4 focus-visible:ring-offset-white dark:focus-visible:ring-offset-stone-950 rounded"
>
{{ end }}

  {{/* Image Container */}}
  <div class="w-full aspect-[4/5] overflow-hidden bg-stone-100 dark:bg-stone-900 relative shadow-sm transition-all duration-500 group-hover:shadow-xl">
    {{/* Shimmer placeholder */}}
    <div class="absolute inset-0 bg-gradient-to-br from-stone-200 via-stone-100 to-stone-200 dark:from-stone-800 dark:via-stone-900 dark:to-stone-800"></div>

    {{/* Artwork image */}}
    {{ if $priority }}
      {{ partial "thumbnail-priority.html" (dict
        "src" $artwork.image
        "alt" $title
        "title" $title
        "class" "absolute inset-0 w-full h-full object-cover transition-transform duration-700 group-hover:scale-[1.03]"
      ) }}
    {{ else }}
      {{ partial "thumbnail.html" (dict
        "src" $artwork.image
        "alt" $title
        "title" $title
        "class" "absolute inset-0 w-full h-full object-cover transition-transform duration-700 group-hover:scale-[1.03]"
      ) }}
    {{ end }}

    {{/* Hover overlay */}}
    <div class="absolute inset-0 bg-gradient-to-t from-black/30 via-transparent to-transparent opacity-0 group-hover:opacity-100 transition-opacity duration-500"></div>

    {{/* Dimensions badge - appears on hover */}}
    {{ if and $showDimensions $artwork.dimensions }}
    <div class="absolute bottom-3 right-3 px-2 py-1 bg-white/90 dark:bg-black/80 backdrop-blur-sm text-xs text-stone-600 dark:text-stone-300 tracking-wide opacity-0 group-hover:opacity-100 transition-all duration-300 translate-y-2 group-hover:translate-y-0">
      {{ $artwork.dimensions }}
    </div>
    {{ end }}

    {{/* "View" button - slides up on hover */}}
    <div class="absolute bottom-0 left-0 right-0 p-6 translate-y-full group-hover:translate-y-0 transition-transform duration-300">
      <span class="inline-block bg-white/90 dark:bg-stone-950/90 backdrop-blur px-4 py-2 text-stone-900 dark:text-stone-100 font-mono text-xs uppercase tracking-widest shadow-sm">
        {{ $viewText }}
      </span>
    </div>
  </div>

  {{/* Metadata */}}
  <div class="flex flex-col gap-2 w-full px-2">
    <h3 class="text-xl md:text-2xl leading-tight group-hover:text-stone-600 dark:group-hover:text-stone-300 transition-colors">
      {{ $title }}
    </h3>
    <div class="flex items-center gap-3 text-sm text-stone-500 dark:text-stone-400 font-mono tracking-wide border-t border-stone-100 dark:border-stone-800 pt-2 mt-1 w-full">
      {{ with $artwork.year }}<span class="font-medium">{{ . }}</span>{{ end }}
      {{ if and $artwork.year $medium }}<span class="w-1 h-1 rounded-full bg-stone-300 dark:bg-stone-700"></span>{{ end }}
      <span>{{ $medium }}</span>
    </div>
  </div>

{{ if eq $type "button" }}
</button>
{{ else }}
</a>
{{ end }}
