{{ define "main" }}
{{/* Sculptures Gallery - Design OS SculpturesGallery style with Lightbox */}}
<div class="section-page">
  <main class="section-content section-wide">

    {{/* Page Title with Gallery Navigation */}}
    {{ partial "_page-title.html" (dict
      "title" (i18n "sculptures")
      "showGalleryNav" true
      "activeSection" "sculptures"
      "context" $
    ) }}

    {{ $allSculptures := .Site.Data.sculptures.sculptures }}

    {{/* Get year range */}}
    {{ $years := slice }}
    {{ range $allSculptures }}
      {{ $year := .year }}
      {{ if not (in $years $year) }}
        {{ $years = $years | append $year }}
      {{ end }}
    {{ end }}
    {{ $sortedYears := sort $years "value" "desc" }}

    {{/* Gallery Meta - Stats & Separator */}}
    {{ $metaText := printf "%d %s" (len $allSculptures) (i18n "works") }}
    {{ if gt (len $sortedYears) 0 }}
      {{ $metaText = printf "%s · %d–%d" $metaText (index $sortedYears (sub (len $sortedYears) 1)) (index $sortedYears 0) }}
    {{ end }}
    {{ partial "_section-separator.html" (dict "text" $metaText) }}

    {{/* Artwork Grid */}}
    <div class="grid grid-cols-1 sm:grid-cols-2 lg:grid-cols-3 xl:grid-cols-4 gap-x-6 md:gap-x-8 gap-y-12 md:gap-y-16">
      {{ range $index, $sculpture := $allSculptures }}
      {{/* Artwork Card - using shared partial */}}
      {{ partial "_artwork-card.html" (dict
        "artwork" $sculpture
        "index" $index
        "lang" $.Site.Language.Lang
        "context" $
        "type" "button"
        "showDimensions" true
        "priority" (eq $index 0)
        "headingLevel" 2
      ) }}
      {{ end }}
    </div>

    {{/* Gallery Footer */}}
    <footer class="mt-32 pt-8 border-t border-stone-200 dark:border-stone-800">
      <p class="text-sm text-stone-400 dark:text-stone-600 tracking-wider">
        {{ len $allSculptures }} {{ i18n "works" }}
      </p>
    </footer>

  </main>
</div>

{{/* Include Lightbox */}}
{{ partial "lightbox.html" . }}

{{/* Initialize Lightbox with artwork data - Hugo generates responsive optimized URLs */}}
<script>
  document.addEventListener('DOMContentLoaded', function() {
    initLightbox([
      {{ range $allSculptures }}
      {{- $assetPath := replace .image "/images/" "images/" -}}
      {{- $img := resources.Get $assetPath -}}
      {{- if $img -}}
      {{- $img800 := $img.Resize "800x webp q85" -}}
      {{- $img1200 := $img.Resize "1200x webp q85" -}}
      {{- $img1600 := $img.Resize "1600x webp q90" -}}
      {
        id: "{{ .id }}",
        title_de: "{{ .title_de }}",
        title_en: "{{ .title_en }}",
        year: {{ .year }},
        medium_de: "{{ .medium_de }}",
        medium_en: "{{ .medium_en }}",
        dimensions: "{{ .dimensions }}",
        image_800: "{{ $img800.RelPermalink }}",
        image_1200: "{{ $img1200.RelPermalink }}",
        image_1600: "{{ $img1600.RelPermalink }}",
        image: "{{ $img1200.RelPermalink }}"
      },
      {{- end -}}
      {{ end }}
    ]);
  });
</script>
{{ end }}
