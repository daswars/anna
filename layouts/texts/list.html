{{ define "main" }}
{{/* Texts page - Design OS TextsList style */}}
<div class="section-page">
  <main class="section-content section-narrow">
    {{/* Page Title */}}
    {{ partial "_page-title.html" (dict "title" (i18n "texts")) }}

    {{ $texts := .Site.Data.texts.texts }}

    {{/* Separator with count */}}
    {{ if $texts }}
      {{ $metaText := printf "%d %s" (len $texts) (i18n "texts") }}
      {{ partial "_section-separator.html" (dict "text" $metaText) }}
    {{ else }}
      {{ partial "_section-separator.html" }}
    {{ end }}
    {{ if $texts }}
    <div class="space-y-24">
      {{ range $texts }}
      <article class="group border-t border-stone-200 dark:border-stone-800 pt-8 transition-colors hover:border-stone-400 dark:hover:border-stone-600">
        {{/* Meta info */}}
        <div class="flex items-center gap-4 text-xs font-mono tracking-widest text-stone-500 dark:text-stone-500 mb-6 uppercase">
          <time datetime="{{ .date }}">
            {{ dateFormat "January 2006" .date }}
          </time>
          <span>â€”</span>
          <span>
            {{ if eq .type "artist-statement" }}
              {{ i18n "artist_statement" }}
            {{ else if eq .type "essay" }}
              {{ i18n "essay" }}
            {{ else }}
              {{ .type }}
            {{ end }}
          </span>
        </div>

        {{/* Title */}}
        <h2 class="text-3xl md:text-4xl font-normal text-stone-900 dark:text-stone-50 mb-6 leading-tight group-hover:text-stone-600 dark:group-hover:text-stone-300 transition-colors">
          {{ if eq $.Site.Language.Lang "de" }}{{ .title_de }}{{ else }}{{ .title_en }}{{ end }}
        </h2>

        {{/* Author if not the artist */}}
        {{ if and .author (ne .author "Anna Weber") }}
        <p class="text-sm text-stone-500 dark:text-stone-400 mb-6 font-mono">
          {{ i18n "by_author" }} {{ .author }}
        </p>
        {{ end }}

        {{/* Content - first paragraph as excerpt */}}
        {{ $content := "" }}
        {{ if eq $.Site.Language.Lang "de" }}
          {{ $content = .content_de }}
        {{ else }}
          {{ $content = .content_en }}
        {{ end }}

        {{/* Split content into paragraphs and show first one */}}
        <div class="text-lg text-stone-600 dark:text-stone-400 leading-relaxed mb-8 font-light max-w-2xl prose prose-stone dark:prose-invert">
          {{ $paragraphs := split $content "\n\n" }}
          {{ if $paragraphs }}
            <p>{{ index $paragraphs 0 | truncate 200 }}</p>
          {{ end }}
        </div>

        {{/* Read more link */}}
        <a href="#text-{{ .id }}" class="inline-flex items-center gap-3 text-sm font-mono uppercase tracking-widest text-stone-900 dark:text-stone-100 group-hover:text-stone-600 dark:group-hover:text-stone-400 transition-colors">
          <span>{{ i18n "read_more" }}</span>
          <span class="transition-transform group-hover:translate-x-2">&rarr;</span>
        </a>
      </article>
      {{ end }}
    </div>

    {{/* Full texts (expandable sections) */}}
    <div class="mt-32 pt-16 border-t border-stone-200 dark:border-stone-800">
      <h2 class="text-2xl font-light text-stone-900 dark:text-stone-50 mb-16">
        {{ i18n "full_texts" }}
      </h2>

      {{ range $texts }}
      <article id="text-{{ .id }}" class="mb-24 scroll-mt-24">
        <h3 class="text-2xl md:text-3xl font-normal text-stone-900 dark:text-stone-50 mb-4 leading-tight">
          {{ if eq $.Site.Language.Lang "de" }}{{ .title_de }}{{ else }}{{ .title_en }}{{ end }}
        </h3>

        {{ if and .author (ne .author "Anna Weber") }}
        <p class="text-sm text-stone-500 dark:text-stone-400 mb-8 font-mono">
          {{ i18n "by_author" }} {{ .author }}
        </p>
        {{ end }}

        <div class="prose prose-stone dark:prose-invert prose-lg max-w-none font-light leading-loose text-stone-700 dark:text-stone-300">
          {{ $content := "" }}
          {{ if eq $.Site.Language.Lang "de" }}
            {{ $content = .content_de }}
          {{ else }}
            {{ $content = .content_en }}
          {{ end }}
          {{ $content | markdownify }}
        </div>
      </article>
      {{ end }}
    </div>
    {{ else }}
    <p class="text-stone-500 dark:text-stone-400">
      {{ i18n "no_texts" }}
    </p>
    {{ end }}
  </main>
</div>
{{ end }}
