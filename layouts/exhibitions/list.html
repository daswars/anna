{{ define "main" }}
{{/* Exhibitions page - Design OS style */}}
<div class="section-page">
  <main class="section-content section-standard">
    {{/* Page Title */}}
    {{ partial "_page-title.html" (dict "title" (i18n "exhibitions")) }}

    {{/* Get unique years and sort descending */}}
    {{ $allExhibitions := .Site.Data.exhibitions.exhibitions }}
    {{ $years := slice }}
    {{ range $allExhibitions }}
      {{ $year := .year }}
      {{ if not (in $years $year) }}
        {{ $years = $years | append $year }}
      {{ end }}
    {{ end }}
    {{ $sortedYears := sort $years "value" "desc" }}

    {{/* Separator with stats */}}
    {{ $metaText := printf "%d %s · %d–%d" (len $allExhibitions) (i18n "exhibitions") (index $sortedYears (sub (len $sortedYears) 1)) (index $sortedYears 0) }}
    {{ partial "_section-separator.html" (dict "text" $metaText) }}

    {{/* Exhibitions by year */}}
    <div class="space-y-24">
      {{ range $sortedYears }}
        {{ $year := . }}
        <section>
          {{/* Year heading - using shared partial */}}
          {{ partial "_year-section.html" (dict "year" $year "size" "medium") }}

          {{/* Exhibitions list for this year */}}
          <div class="space-y-6">
            {{ range where $allExhibitions "year" $year }}
            <div class="group p-6 -mx-6 hover:bg-stone-50 dark:hover:bg-stone-900/30 transition-colors rounded-sm">
              <div class="flex flex-col md:flex-row md:items-start gap-4 md:gap-12">
                {{/* Solo/Group badge */}}
                <div class="min-w-[6rem]">
                  {{ if eq .type "solo" }}
                    {{ partial "_badge.html" (dict "type" "solo" "text" (i18n "solo")) }}
                  {{ else }}
                    {{ partial "_badge.html" (dict "type" "group" "text" (i18n "group")) }}
                  {{ end }}
                </div>

                <div class="flex-1">
                  {{/* Title */}}
                  <h3 class="font-serif text-xl md:text-2xl font-light text-stone-900 dark:text-stone-100 group-hover:text-stone-600 dark:group-hover:text-stone-400 transition-colors mb-2">
                    {{ if .title }}"{{ .title }}"{{ else }}{{ i18n "exhibitions" }}{{ end }}
                  </h3>

                  {{/* Location */}}
                  <p class="text-stone-600 dark:text-stone-400 font-light">
                    {{ with .venue }}{{ . }}{{ end }}{{ if and .venue .city }}, {{ end }}{{ .city }}{{ with .country }}, {{ . }}{{ end }}
                  </p>
                </div>
              </div>
            </div>
            {{ end }}
          </div>
        </section>
      {{ end }}
    </div>

    {{/* Footer */}}
    <footer class="mt-32 pt-8 border-t border-stone-200 dark:border-stone-800">
      <p class="text-sm text-stone-400 dark:text-stone-600 tracking-wider">
        {{ len $allExhibitions }} {{ i18n "exhibitions_total" }}
      </p>
    </footer>
  </main>
</div>
{{ end }}
