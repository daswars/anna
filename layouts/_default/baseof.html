<!DOCTYPE html>
<html lang="{{ .Site.Language.Lang }}" class="scroll-smooth dark">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>{{ if .Title }}{{ .Title }} | {{ end }}{{ .Site.Title }}</title>
  <meta name="description" content="{{ with .Description }}{{ . }}{{ else }}{{ .Site.Params.artist.name }} - {{ with .Site.Language.Params.subtitle }}{{ . }}{{ end }}{{ end }}">

  {{/* Canonical URL */}}
  <link rel="canonical" href="{{ .Permalink }}">

  {{/* Favicons */}}
  <link rel="icon" type="image/x-icon" href="/favicon.ico">
  <link rel="icon" type="image/png" sizes="32x32" href="/favicon-32x32.png">
  <link rel="icon" type="image/png" sizes="16x16" href="/favicon-16x16.png">
  <link rel="apple-touch-icon" sizes="180x180" href="/apple-touch-icon.png">
  <link rel="manifest" href="/site.webmanifest">

  {{/* Open Graph */}}
  <meta property="og:title" content="{{ if .Title }}{{ .Title }}{{ else }}{{ .Site.Title }}{{ end }}">
  <meta property="og:description" content="{{ with .Description }}{{ . }}{{ else }}{{ .Site.Params.artist.name }} - {{ with .Site.Language.Params.subtitle }}{{ . }}{{ end }}{{ end }}">
  <meta property="og:type" content="{{ if .IsPage }}article{{ else }}website{{ end }}">
  <meta property="og:url" content="{{ .Permalink }}">
  <meta property="og:image" content="{{ "images/og-image.jpg" | absURL }}">
  <meta property="og:locale" content="{{ .Site.Language.Lang }}_{{ upper .Site.Language.Lang }}">
  <meta property="og:site_name" content="{{ .Site.Title }}">

  {{/* Twitter Card */}}
  <meta name="twitter:card" content="summary_large_image">
  <meta name="twitter:title" content="{{ if .Title }}{{ .Title }}{{ else }}{{ .Site.Title }}{{ end }}">
  <meta name="twitter:description" content="{{ with .Description }}{{ . }}{{ else }}{{ .Site.Params.artist.name }} - {{ with .Site.Language.Params.subtitle }}{{ . }}{{ end }}{{ end }}">
  <meta name="twitter:image" content="{{ "images/og-image.jpg" | absURL }}">

  {{/* Hreflang for multilingual */}}
  {{ if .IsTranslated }}
    {{ range .Translations }}
    <link rel="alternate" hreflang="{{ .Language.Lang }}" href="{{ .Permalink }}">
    {{ end }}
    <link rel="alternate" hreflang="{{ .Language.Lang }}" href="{{ .Permalink }}">
  {{ end }}
  <link rel="alternate" hreflang="x-default" href="{{ .Site.BaseURL }}">

  {{/* Schema.org Structured Data */}}
  {{ if .IsHome }}
  <script type="application/ld+json">
  {
    "@context": "https://schema.org",
    "@type": "Person",
    "name": "{{ .Site.Params.artist.name }}",
    "jobTitle": "{{ if eq .Site.Language.Lang "de" }}Künstlerin{{ else }}Artist{{ end }}",
    "description": "{{ if eq .Site.Language.Lang "de" }}Künstlerin für Malerei und Skulptur aus Düsseldorf{{ else }}Artist for Painting and Sculpture from Düsseldorf{{ end }}",
    "url": "{{ .Site.BaseURL }}",
    "image": "{{ "images/og-image.jpg" | absURL }}",
    "address": {
      "@type": "PostalAddress",
      "addressLocality": "Düsseldorf",
      "addressCountry": "DE"
    },
    "knowsAbout": ["{{ if eq .Site.Language.Lang "de" }}Malerei{{ else }}Painting{{ end }}", "{{ if eq .Site.Language.Lang "de" }}Skulptur{{ else }}Sculpture{{ end }}", "{{ if eq .Site.Language.Lang "de" }}Bildende Kunst{{ else }}Fine Art{{ end }}"]
  }
  </script>
  {{ end }}

  {{/* Preload critical fonts to avoid render-blocking chain */}}
  <link rel="preload" href="/fonts/DM_Sans/DMSans-Variable.woff2" as="font" type="font/woff2" crossorigin>

  {{/* Tailwind CSS via Hugo Pipes */}}
  {{ $css := resources.Get "css/main.css" | css.TailwindCSS }}
  {{ if hugo.IsProduction }}
    {{ $css = $css | minify | fingerprint }}
  {{ end }}

  {{/* Critical CSS inline - minimal styles for first paint */}}
  <style>
    @font-face{font-family:'DM Sans';src:url('/fonts/DM_Sans/DMSans-Variable.woff2') format('woff2');font-weight:100 900;font-style:normal;font-display:swap}
    :root{--font-family-sans:'DM Sans',system-ui,sans-serif}
    html{scroll-behavior:smooth}
    body{font-family:var(--font-family-sans);margin:0;min-height:100vh;-webkit-font-smoothing:antialiased;-moz-osx-font-smoothing:grayscale}
    .dark{color-scheme:dark}
    body{background-color:#fafaf9;color:#1c1917}
    .dark body{background-color:#1c1917;color:#f5f5f4}
    .flex{display:flex}.flex-col{flex-direction:column}.min-h-screen{min-height:100vh}.flex-1{flex:1 1 0%}
  </style>

  {{/* Preload full CSS */}}
  <link rel="preload" href="{{ $css.RelPermalink }}" as="style" {{ if hugo.IsProduction }}integrity="{{ $css.Data.Integrity }}"{{ end }}>

  {{/* Load CSS asynchronously to avoid render-blocking */}}
  <link rel="stylesheet" href="{{ $css.RelPermalink }}" {{ if hugo.IsProduction }}integrity="{{ $css.Data.Integrity }}"{{ end }} media="print" onload="this.media='all'">

  {{/* Fallback for browsers with JS disabled */}}
  <noscript>
    <link rel="stylesheet" href="{{ $css.RelPermalink }}" {{ if hugo.IsProduction }}integrity="{{ $css.Data.Integrity }}"{{ end }}>
  </noscript>

  {{/* Theme Script (must be in head to prevent flash) */}}
  <script>
    (function() {
      const stored = localStorage.getItem('theme');
      if (stored === 'dark') {
        document.documentElement.classList.add('dark');
      } else {
        document.documentElement.classList.remove('dark');
      }
    })();
  </script>

  {{ block "head" . }}{{ end }}
</head>
<body class="min-h-screen bg-stone-50 dark:bg-stone-900 text-stone-900 dark:text-stone-100 antialiased">
  <div class="flex min-h-screen flex-col">
    {{ partial "header.html" . }}

    <main class="flex-1">
      {{ block "main" . }}{{ end }}
    </main>

    {{ partial "footer.html" . }}
  </div>

  {{ block "scripts" . }}{{ end }}

  <!-- Dark Mode Toggle Handler -->
  <script>
    document.addEventListener('DOMContentLoaded', function() {
      const toggle = document.getElementById('theme-toggle');
      if (toggle) {
        toggle.addEventListener('click', function() {
          const isDark = document.documentElement.classList.toggle('dark');
          localStorage.setItem('theme', isDark ? 'dark' : 'light');
        });
      }
    });
  </script>
</body>
</html>
